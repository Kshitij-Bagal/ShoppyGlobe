import{u as x,r as n,j as t,f as y,h as v,d as j,L as h,i as f}from"./index-BsOYX6uE.js";const g=({item:e})=>{const a=x(),[r,s]=n.useState(!1),[i,l]=n.useState(e.quantity),[d,c]=n.useState(null),o=async m=>{const u=i+m;if(!(u<1)){s(!0);try{l(u),await a(y({id:e.productId,quantity:u}))}catch{c("Failed to update quantity. Please try again."),l(e.quantity)}finally{s(!1)}}},p=async()=>{s(!0);try{await a(v(e.productId))}catch{c("Failed to remove item. Please try again.")}finally{s(!1)}};return e.thumbnail,t.jsxs("div",{className:"cart-item",children:[t.jsxs("div",{className:"cart-item-details",children:[t.jsx("img",{className:"cart-item-image",src:e.thumbnail,alt:e.title}),t.jsxs("div",{children:[t.jsx("h3",{children:e.title}),t.jsxs("p",{children:["Price: $",e.price]}),t.jsxs("div",{className:"cart-item-quantity",children:[t.jsx("label",{htmlFor:`quantity-${e.productId}`,children:"Quantity:"}),t.jsxs("div",{className:"quantity-controls",children:[t.jsx("button",{onClick:()=>o(-1),disabled:r||i<=1,children:"-"}),t.jsx("span",{children:i}),t.jsx("button",{onClick:()=>o(1),disabled:r,children:"+"})]}),d&&t.jsx("span",{id:`quantity-error-${e.productId}`,className:"error-message",children:d})]})]})]}),t.jsx("div",{className:"cart-item-actions",children:t.jsx("button",{onClick:p,disabled:r,"aria-label":`Remove ${e.title} from cart`,children:r?"Removing...":"Remove"})})]})},C=()=>{const e=j(a=>a.cart.items);return t.jsxs("div",{className:"cart",children:[t.jsx("h2",{children:"Your Cart"}),e.length===0?t.jsxs("p",{children:["Your cart is empty. ",t.jsx(h,{to:"/products",children:"Shop now!"})]}):t.jsx("div",{className:"cart-items",children:e.map(a=>t.jsx(g,{item:a},a.productId||a.id))})]})},q=()=>{const e=x(),a=j(c=>c.cart.items||[]),[r,s]=n.useState(!0),[i,l]=n.useState(!1);n.useEffect(()=>{(async()=>{try{s(!0),await e(f())}catch(o){console.error("Failed to fetch cart:",o)}finally{s(!1)}})()},[e]);const d=async()=>{try{l(!0)}catch(c){console.error("Order placement failed:",c)}};return r?t.jsx("div",{children:"Loading..."}):t.jsx("div",{className:"app-container",children:t.jsxs("div",{className:"cart-page",children:[t.jsx("h2",{children:"Your Shopping Cart"}),a.length===0?t.jsxs("div",{className:"empty-cart",children:[t.jsx("p",{children:"Your cart is empty!"}),t.jsx(h,{to:"/browse",children:"Browse Products"})]}):t.jsxs(t.Fragment,{children:[t.jsx(C,{cartItems:a}),t.jsxs("div",{className:"cart-summary",children:[t.jsxs("h3",{children:["Total: $",N(a).toFixed(2)]}),t.jsx(h,{to:"/checkout",className:"checkout-btn",children:t.jsx("button",{onClick:d,className:"checkout-btn",children:i?"Order Placed":"Place Order"})})]})]})]})})},N=e=>e.reduce((a,r)=>a+r.price*r.quantity,0);export{q as default};
